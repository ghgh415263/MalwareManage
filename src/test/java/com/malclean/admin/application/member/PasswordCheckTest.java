package com.malclean.admin.application.member;

import com.malclean.admin.application.member.exceptions.WeakPasswordException;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.AssertionsForClassTypes.assertThatThrownBy;

public class PasswordCheckTest {

    private PasswordChecker passwordChecker;

    @BeforeEach
    public void beforeEach() {
        passwordChecker = new PasswordChecker();
    }

    @Test
    void 문제없는_패스워드() {
        String password = "1q2w3e4r5t!";

        passwordChecker.check(password);
    }

    @Test
    void 특수문자없는_패스워드() {
        String password = "1q2w3e4r5t";

        assertThatThrownBy(() -> passwordChecker.check(password))
                .isInstanceOf(WeakPasswordException.class)
                .hasMessage("적어도 하나 이상의 특수문자를 포함해주세요.");
    }

    @Test
    void 숫자없는_패스워드() {
        String password = "asdfasdf!";

        assertThatThrownBy(() -> passwordChecker.check(password))
                .isInstanceOf(WeakPasswordException.class)
                .hasMessage("적어도 하나 이상의 숫자를 포함해주세요.");
    }
}
