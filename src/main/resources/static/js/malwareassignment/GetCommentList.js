export const getNextCommentList = () => {

    const assignmentId = window.location.pathname.split("/").at(-1);
    let url = '/assignments/' + assignmentId + '/comments';

    let options = {
        method: 'Get',
        mode: 'cors',
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'text/html; charset=UTF-8'
        },
    }

    fetch(url, options)
        .then((response) => {
            if (response.ok) {
                return response.json()
            }
        })
        .then(result => {
            for (const comment of result.content){
                const $li = makeCommentTag(comment)
                $('.list-group').append($li);
            }

        })

}

const makeCommentTag = (comment) => {
    const $li = document.createElement('li');
    $li.setAttribute('class','list-group-item');
    $li.setAttribute('data-id',comment.id);

    const $strong = document.createElement('strong');
    $strong.innerText = comment.writerUsername;

    const $div = document.createElement('div');
    $div.innerText = comment.content;

    const $deleteButton = document.createElement('button');
    $deleteButton.setAttribute('class', 'comment-delete-btn');
    $deleteButton.innerText = "삭제";

    const $updateFormButton = document.createElement('button');
    $updateFormButton.setAttribute('class', 'comment-patchForm-btn');
    $updateFormButton.innerText = "수정";

    $li.append($strong, $div, $deleteButton, $updateFormButton);

    return $li;
}