window.onload  = () => {
    getNextCommentList(null);
}

const getNextCommentList = (lastCommentId) => {
    const assignmentId = window.location.pathname.split("/").at(-1);

    let url = '/assignments/' + assignmentId + '/comments';
    if (lastCommentId !== null) {
        url = url + '?lastCommentId=' + lastCommentId;
    }

    let options = {
        method: 'GET',
        mode: 'cors',
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json;charset=UTF-8'
        },
    }

    fetch(url, options)
        .then((response) => {
            if (response.ok) {
                return response.json()
            }
        })
        .then(result => {
            for (const comment of result.content){
                $('.list-group').append(
                    "<li class='list-group-item' data-id='" + comment.id + "'>" +
                    "<strong>" + comment.writerUsername + "</strong>" +
                    "<div>" + comment.content + "</div>" +
                    "</li>"
                )
            }
        })
}

document.getElementsByClassName('btn').item(1)
    .addEventListener('click', (event) => {
        const lastCommentId = $(".list-group li").last().data("id");
        getNextCommentList(lastCommentId);
    })