import { getMembers } from './member-client.js';
import { PaginationBar } from "../PaginationBar.js";
$('#btn_file_append').click(function(){
    $('.file_list').append(
        '<tr>' +
        '<td><input type="file" name="multipartFileList" class="form-control"></td>' +
        '<td><button type="button" class="btn_delete btn btn-sm">삭제</button></td>' +
        '</tr>'
    );
});
$('.file_list').on('click','.btn_delete', function(){
    $(this).closest('tr').remove();
});


const $memberModal = document.getElementById('memberModal');
$memberModal.addEventListener('shown.bs.modal', async () => {
    const pageable = await getMembers(1);

    let memberCheckBars = ``
    pageable.content.forEach(member => {
        memberCheckBars += makeMemberCheckBar(member.id, member.username, member.department, member.authority)
    })
    const $paginationBarWapper = document.querySelector('.paging');
    const paginationBar = new PaginationBar($paginationBarWapper);
    paginationBar.renderPaginationBar(pageable.customPageable)

    const $membersModal = document.getElementById('membersGroup')
    $membersModal.innerHTML = memberCheckBars
})

let myModal = new bootstrap.Modal($memberModal, {
    keyboard: false
})
let $memberBars = document.querySelector('.list-group');
$memberBars.addEventListener('click', function clickMember(event){
    let $input = document.getElementById('assigneeId');
    $input.value = event.target.dataset.memberId
    myModal.hide();
})

function makeMemberCheckBar(id, username, department, authority) {
    return `<a class="list-group-item list-group-item-action" data-bs-toggle="list" role="tab" aria-controls="list-home" data-member-id="${id}">유저이름: ${username}</a>`
}