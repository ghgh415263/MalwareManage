import { makePaginationBar } from "../makePaginationBar.js";
import { pagnationPage } from "../pagnationPage.js";
import { getMalwareList } from "./GetMalwareList.js";
import {makeMalwareTag} from "./makeMalwareTag.js";

const reloadMalwareList = (page) => {
    getMalwareList(page)
        .then(result => {
            $('.list').empty();
            result.content.forEach(malware => {
                const malwareTag = makeMalwareTag(malware);
                $('.list').append(malwareTag);
            })
            let paginationBarTag = makePaginationBar(result.customPageable);
            document.querySelector('.paging').replaceChildren(paginationBarTag);
        })
        .then(() => {
            let callback = (page) => {
                return getMalwareList(page)
                    .then(result => {
                        $('.list').empty();
                        result.content.forEach(malware => {
                            const malwareTag = makeMalwareTag(malware);
                            $('.list').append(malwareTag);
                        })
                        let paginationBarTag = makePaginationBar(result.customPageable);
                        document.querySelector('.paging').replaceChildren(paginationBarTag);
                    })
            }
            pagnationPage(callback)
        })
}

window.onload  = () => {
    reloadMalwareList(1)
}