package com.malclean.admin.controller.malwarefile;

import com.malclean.admin.entity.malware.Malware;
import com.malclean.admin.entity.MalwareFile;
import com.malclean.admin.entity.MalwareMalwareFileMap;
import com.malclean.admin.pagination.CustomPage;
import lombok.Getter;
import org.springframework.data.domain.Page;

import java.util.List;

@Getter
public class MalwareFileDetailDto {

    private Long id;

    private String signature;

    private String filename;

    private CustomPage<MalwareInFileDetailDto> malwarePage;

    public MalwareFileDetailDto(MalwareFile malwareFile, Page<MalwareMalwareFileMap> malwareMalwareFileMapPage) {
        id = malwareFile.getId();
        signature = malwareFile.getSignature();
        filename = malwareFile.getFilename();

        List<MalwareInFileDetailDto> malwareInFileDetailDtoList = malwareMalwareFileMapPage
                .map(malwareMalwareFileMap -> {
                    Malware malware = malwareMalwareFileMap.getMalware();
                    return new MalwareInFileDetailDto(malware);
                })
                .toList();

        malwarePage = new CustomPage<>(malwareInFileDetailDtoList, malwareMalwareFileMapPage.getPageable(), malwareMalwareFileMapPage.getTotalElements());
    }
}