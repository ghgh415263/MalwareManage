package com.malclean.admin.controller.announcement;

import com.malclean.admin.entity.Announcement;
import com.malclean.admin.enumtype.AnnouncementStatusType;
import com.malclean.admin.service.announcement.AnnouncementDetailService;
import lombok.AllArgsConstructor;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestParam;

import java.time.LocalDateTime;

@RequiredArgsConstructor
@Slf4j
@Controller
public class AnnouncementDetailController {

    private final AnnouncementDetailService announcementDetailService;

    public String getDetail(@RequestParam Long id,
                            Model model) {

        Announcement announcement = announcementDetailService.getDetail(id);
        AnnouncementDetailResponse announcementDetailResponse = new AnnouncementDetailResponse(announcement);
        model.addAttribute("announcementDetailResponse", announcementDetailResponse);
        return "";
    }

    @Getter
    @NoArgsConstructor
    @AllArgsConstructor
    public static class AnnouncementDetailResponse {

        private Long id;

        private String title;

        private String content;

        private AnnouncementStatusType announcementStatus;

        private LocalDateTime createdTime;

        private String posterUsername;

        private Long posterId;

        public AnnouncementDetailResponse(Announcement announcement){
            this.id = announcement.getId();
            this.title = announcement.getTitle();
            this.content = announcement.getContent();
            this.announcementStatus = announcement.getAnnouncementStatus();
            this.createdTime = announcement.getCreatedTime();
            this.posterUsername = announcement.getPoster().getUsername();
            this.posterId = announcement.getPoster().getId();
        }

    }
}
