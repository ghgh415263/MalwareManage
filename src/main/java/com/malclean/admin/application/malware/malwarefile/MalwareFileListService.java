package com.malclean.admin.application.malware.malwarefile;

import com.malclean.admin.domain.malware.MalwareFile;
import com.malclean.admin.domain.malware.malwarefile.DslMalwareFileRepository;
import com.malclean.admin.domain.malware.malwarefile.MalwareFileSearchRequest;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageImpl;
import org.springframework.data.domain.Pageable;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@RequiredArgsConstructor
@Slf4j
@Service
public class MalwareFileListService {

    private final DslMalwareFileRepository dslMalwareFileRepository;

    @Transactional(readOnly = true)
    public Page<MalwareFile> getList(MalwareFileSearchRequest searchRequest, Pageable pageable) {

        List<MalwareFile> malwareFileList = dslMalwareFileRepository.findAll(searchRequest, pageable);
        Long totalCount = dslMalwareFileRepository.countBySearch(searchRequest);

        return new PageImpl<>(malwareFileList, pageable, totalCount);
    }
}
