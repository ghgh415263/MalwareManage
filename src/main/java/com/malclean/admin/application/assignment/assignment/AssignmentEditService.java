package com.malclean.admin.application.assignment.assignment;

import com.malclean.admin.application.assignment.assignment.requestdto.AssignmentEditRequest;
import com.malclean.admin.application.common.exception.NotExistEntityException;
import com.malclean.admin.domain.assignment.assignment.AssignmentStatusType;
import com.malclean.admin.domain.assignment.assignment.MalwareAssignment;
import com.malclean.admin.domain.assignment.assignment.MalwareAssignmentRepository;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

@RequiredArgsConstructor
@Slf4j
@Service
public class AssignmentEditService {

    private final MalwareAssignmentRepository malwareAssignmentRepository;

    @Transactional
    public void editMalwareAssignment(Long assignmentId, AssignmentEditRequest assignmentEditRequest, Long loginMemberId) {
        MalwareAssignment malwareAssignment = malwareAssignmentRepository.findById(assignmentId)  /*todo 권한 필요한가?*/
                .orElseThrow(NotExistEntityException::new);

        malwareAssignment.editTitle(assignmentEditRequest.getTitle());
        malwareAssignment.editContent(assignmentEditRequest.getContent());

        AssignmentStatusType assignmentStatusType = AssignmentStatusType.toEnumType(assignmentEditRequest.getAssignmentStatus());
        malwareAssignment.editAssignmentStatus(assignmentStatusType);
        malwareAssignment.editEstimatedTime(assignmentEditRequest.getEstimatedTime());
    }
}
