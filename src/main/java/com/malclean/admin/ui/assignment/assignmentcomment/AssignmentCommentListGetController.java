package com.malclean.admin.ui.assignment.assignmentcomment;

import com.malclean.admin.ui.common.pagination.CustomPage;
import com.malclean.admin.dao.assignment.assignmentcomment.AssignmentCommentInPage;
import com.malclean.admin.dao.assignment.assignmentcomment.AssignmentCommentListDao;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.web.PageableDefault;
import org.springframework.web.bind.annotation.*;


@RequiredArgsConstructor
@Slf4j
@RestController
public class AssignmentCommentListGetController {

    public final AssignmentCommentListDao assignmentCommentListDao;

    @GetMapping("/assignments/{assignmentId}/comments")
    public CustomPage assignmentCommentList(@PathVariable Long assignmentId,
                                            @PageableDefault(size=1) Pageable pageable,
                                            @SessionAttribute(name = "loginMemberId") Long loginMemberId) {

        Page<AssignmentCommentInPage> paging = assignmentCommentListDao.findPage(assignmentId, loginMemberId, pageable);
        CustomPage<AssignmentCommentInPage> pagingResponse = new CustomPage<>(paging.getContent(), paging.getPageable(), paging.getTotalElements());
        return pagingResponse;
    }
}
