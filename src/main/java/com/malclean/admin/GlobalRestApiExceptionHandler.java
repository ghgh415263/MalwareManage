package com.malclean.admin;

import lombok.AllArgsConstructor;
import lombok.Getter;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.RestControllerAdvice;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@RestControllerAdvice
public class GlobalRestApiExceptionHandler {

    @ExceptionHandler
    protected RestApiErrorRes handleException(RestApiException ex, HttpServletRequest request, HttpServletResponse response) {
        response.setStatus(ex.getStatus().value());
        return new RestApiErrorRes(request.getRequestURI(), ex.getTitle(), ex.getDetail(), ex.getInstance(), ex.getStatus().value());
    }

    @Getter
    @AllArgsConstructor
    static class RestApiErrorRes{
        private final String type;
        private final String title;
        private final String detail;
        private final String instance;
        private final Integer status;
    }
}
