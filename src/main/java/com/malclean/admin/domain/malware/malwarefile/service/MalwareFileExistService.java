package com.malclean.admin.domain.malware.malwarefile.service;

import com.malclean.admin.domain.malware.malwarefile.DslMalwareFileRepository;
import com.malclean.admin.domain.malware.malwarefile.MalwareFile;
import com.malclean.admin.domain.malware.malwarefile.SignatureAndFile;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;

import java.util.List;
import java.util.stream.Collectors;

@Service
@RequiredArgsConstructor
public class MalwareFileExistService {

    private final DslMalwareFileRepository dslMalwareFileRepository;

    public List<MalwareFile> findAlreadySavedFiles(List<SignatureAndFile> signatureMultipartFileList){
        List<String> newSignatureList = signatureMultipartFileList.stream()
                .map(signatureMultipartFile -> signatureMultipartFile.getSignature())
                .collect(Collectors.toList());
        return dslMalwareFileRepository.findAllBySignatureList(newSignatureList);  //이미 저장된 같은 파일들을 찾는다.
    }
}
