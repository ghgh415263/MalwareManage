package com.malclean.admin.domain.malware.malwarefile;

import com.malclean.admin.common.pagination.CustomPage;
import com.malclean.admin.domain.malware.malwaremalwarefilemap.MalwareMalwareFileMap;
import lombok.Getter;

import java.time.LocalDateTime;
import java.util.List;
import java.util.stream.Collectors;

@Getter
public class MalwareFileDetailResponse {

    private Long id;

    private String signature;

    private List<MalwareInPage> malwareInPageList;

    public MalwareFileDetailResponse(MalwareFile malwareFile, List<MalwareInPage> mapList) {

        this.id = malwareFile.getId();
        this.signature = malwareFile.getSignature();
        this.malwareInPageList = mapList;
    }

    @Getter
    public static class MalwareInPage {
        private Long id;

        private String title;

        private String nickname;

        private String riskness;

        private LocalDateTime detectedTime;

        private LocalDateTime resolvedTime;

        private String filename;

        public MalwareInPage(MalwareMalwareFileMap malwareMalwareFileMap) {
            this.id = malwareMalwareFileMap.getMalware().getId();
            this.title = malwareMalwareFileMap.getMalware().getTitle();
            this.nickname = malwareMalwareFileMap.getMalware().getNickname();
            this.riskness = malwareMalwareFileMap.getMalware().getRiskness().getValue();
            this.detectedTime = malwareMalwareFileMap.getMalware().getDetectedTime();
            this.resolvedTime = malwareMalwareFileMap.getMalware().getResolvedTime();

            this.filename = malwareMalwareFileMap.getFilename();
        }
    }
}
